diff --git a/hls-plugin-api/src/Ide/Types.hs b/hls-plugin-api/src/Ide/Types.hs
index b7aaa6e2..acf8d1bb 100644
--- a/hls-plugin-api/src/Ide/Types.hs
+++ b/hls-plugin-api/src/Ide/Types.hs
@@ -191,7 +191,7 @@ instance Default Config where
   def = Config
     { checkParents                = CheckOnSave
     , checkProject                = True
-    , formattingProvider          = "ormolu"
+    , formattingProvider          = "fourmolu"
     -- , formattingProvider          = "floskell"
     -- , formattingProvider          = "stylish-haskell"
     , cabalFormattingProvider     = "cabal-fmt"
diff --git a/plugins/hls-fourmolu-plugin/hls-fourmolu-plugin.cabal b/plugins/hls-fourmolu-plugin/hls-fourmolu-plugin.cabal
index e220eaa9..cbe55341 100644
--- a/plugins/hls-fourmolu-plugin/hls-fourmolu-plugin.cabal
+++ b/plugins/hls-fourmolu-plugin/hls-fourmolu-plugin.cabal
@@ -32,7 +32,7 @@ library
   build-depends:
     , base            >=4.12 && <5
     , filepath
-    , fourmolu        ^>=0.3 || ^>=0.4 || ^>= 0.6 || ^>= 0.7 || ^>= 0.8 || ^>= 0.9 || ^>= 0.10 || ^>= 0.11 || ^>= 0.12
+    , fourmolu        ^>=0.3 || ^>=0.4 || ^>= 0.6 || ^>= 0.7 || ^>= 0.8 || ^>= 0.9 || ^>= 0.10 || ^>= 0.11 || ^>= 0.12 || ^>= 0.13
     , ghc
     , ghc-boot-th
     , ghcide          == 2.1.0.0
diff --git a/stack.yaml b/stack.yaml
index c28042b4..bcf2571c 100644
--- a/stack.yaml
+++ b/stack.yaml
@@ -1,4 +1,4 @@
-resolver: nightly-2022-08-15
+resolver: lts-21.1
 
 packages:
 - .
@@ -20,10 +20,10 @@ packages:
 - ./plugins/hls-refine-imports-plugin
 - ./plugins/hls-hlint-plugin
 - ./plugins/hls-rename-plugin
-# - ./plugins/hls-retrie-plugin
-# - ./plugins/hls-splice-plugin
+- ./plugins/hls-retrie-plugin
+- ./plugins/hls-splice-plugin
 # - ./plugins/hls-tactics-plugin
-- ./plugins/hls-stylish-haskell-plugin
+# - ./plugins/hls-stylish-haskell-plugin
 - ./plugins/hls-floskell-plugin
 - ./plugins/hls-fourmolu-plugin
 - ./plugins/hls-pragmas-plugin
@@ -46,13 +46,24 @@ extra-deps:
 - implicit-hie-0.1.2.7@sha256:82bbbb1a8c05f99c8af3c16ac53e80c8648d8bf047b25ed5ce45a135bd736907,3122
 - implicit-hie-cradle-0.5.0.0@sha256:4276f60f3a59bc22df03fd918f73bca9f777de9568f85e3a8be8bd7566234a59,2368
 - monad-dijkstra-0.1.1.3@sha256:d2fc098d7c122555e726830a12ae0423ac187f89de9228f32e56e2f6fc2238e1,1900
-- retrie-1.2.0.1
+- retrie-1.2.2
 - co-log-core-0.3.1.0
 - lsp-2.0.0.0
 - lsp-types-2.0.0.1
 - lsp-test-0.15.0.0
 - hie-bios-0.12.0
 - row-types-1.0.1.2
+- hlint-3.6
+- fourmolu-0.13.0.0
+# fourmolu
+- ghc-lib-parser-9.6.2.20230523
+- Cabal-syntax-3.10.1.0
+- Cabal-3.10.1.0
+- ormolu-0.7.1.0
+# hlint
+- ghc-lib-parser-ex-9.6.0.0
+# hiedb
+- algebraic-graphs-0.6.1
 
 # currently needed for ghcide>extra, etc.
 allow-newer: true
@@ -74,8 +85,9 @@ flags:
 
     ignore-plugins-ghc-bounds: true
     haddockComments: false
-    retrie: false
-    splice: false
+    retrie: true
+    stylishHaskell: false
+    splice: true
     tactic: false
 
   retrie:
@@ -86,8 +98,6 @@ flags:
     auto: false
   hlint:
     ghc-lib: true
-  stylish-haskell:
-    ghc-lib: true
   hyphenation:
     embed: true
 
@@ -96,4 +106,4 @@ nix:
 
 concurrent-tests: false
 
-system-ghc: true
+#system-ghc: true
